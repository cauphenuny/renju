# 设计思路

## 对禁手判断的改进

segment: 一条线上可能对当前点的胜负判断造成影响的所有点，即：连续9个点

使用dp预处理出一个 segment 对应的棋型

以下用`o`表示自己的子，`x` 表示对手的子

upd: 9个点不足以正确判断有禁手的情况下的`attack_pos`，会造成底下的算杀模块出bug

例如：`- - - - o o # - o`

这个`#`是不是冲四attack? 还要再看右边一个点才能确定，如果也是`o`的话就是长连了

一个 segment 的棋型可以由放一个子之后能达到的最好棋型决定

比如：冲四是一个有一个位置落子后能形成连五的 segment，而活四是一个有两个位置落子后能形成连五的 segment

这样就能使用 dp ，从起始状态（连五 `- x o o o o o - - `或长连`x - o o o o o o - `）开始一路 d 出所有状态对应的棋型了

判断禁手时只需要找到四个方向的 segment 即可

如何处理嵌套禁手？

维护一个`attack_col`表示在这些列落子之后能使得棋型升级

如果发现当前是3-3禁手，则通过`attack_col`找到进攻点递归处理，如果进攻点是禁手，则说明这里不是活三，进而当前点不是3-3禁手

---

## 对 MCTS 的改进

### 限制棋盘大小

朴素的 MCTS 棋力并不高，尤其是在 $15\times 15$ 的较大棋盘上，随机落子落出有效的进攻序列还是很慢的，因此可以做一个优化，限制棋盘上能落子的区域，不考虑离当前所有棋子距离超过 $2$ 的位置

### 考虑连五点直接结束



### 对局面以及动作评分

#### 使用一个小型 CNN

#### 使用trivial的评分函数

---

## 算杀

### 威胁空间搜索 （暂译）

原论文：[Go-Moku and Threat-Space Search, Allis et.al., 1994](https://www.researchgate.net/publication/2252447_Go-Moku_and_Threat-Space_Search)

威胁空间搜索, Threat-Space Search, 是一种算杀的高效实现

#### 几种威胁的定义

- (a)Four: 连续五格中攻击者占4个，空1个
- (b)Strait Four: 连续六格中攻击者占中间4个，两端空
- (b)Three: 以下两者之一
	- 连续7格中攻击者占3格，其余空
	- 连续6格中中心4格由攻击者占用，

还没写完，期末周结束之后可能在[个人博客](https://cauphenuny.github.io/)上更新