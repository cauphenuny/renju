// set file type to txt to avoid errors produced by language server.
// clang-format off
void mcts_test_entrance()
{
    // state_t state = {
    //     .board = {[0] = 446080614, [1] = 644438186, [2] = 648391061, [3] = 425290134, [4] = 446063974, [5] = 429479590, [6] = 429234522, [7] = 644257129, [8] = 714435174, [9] = 429561253, [10] = 375740777, [11] = 644240985, [12] = 446081449, [13] = 626612842, [14] = 447124902},
    //     .visited = {[0] = 446080614, [1] = 644438442, [2] = 648391061, [3] = 425290134, [4] = 446063974, [5] = 429479590, [6] = 429234522, [7] = 644257129, [8] = 714435174, [9] = 429561253, [10] = 375740777, [11] = 644240985, [12] = 446081449, [13] = 626612842, [14] = 447124902},
    //     .piece_cnt = 224,
    //     .visited_cnt = 225,
    //     .result = 0,
    //     .count = 3,
    //     .capacity = 225,
    //     .begin = {.x = '\0', .y = '\0'},
    //     .end = {.x = '\x0f', .y = '\x0f'},
    //     .pos = {.x = '\x05', .y = '\x06'},
    //     .win_pos = {[0] = {.x = '\xff', .y = '\xff'}, [1] = {.x = '\xff', .y = '\xff'}},
    //     .id = '\x02',
    //     .score = '\0'};
    // // print_state(state);
    // game_t game = {
    //     .board = { [0] = {[0] = 2, [1] = 1, [2] = 2, [3] = 1, [4] = 2, [5] = 1, [6] = 2, [7] = 2, [8] = 2, [9] = 1, [10] = 1, [11] = 2, [12] = 2, [13] = 2, [14] = 1}, [1] = {[0] = 2, [1] = 2, [2] = 2, [3] = 2, [4] = 0, [5] = 2, [6] = 1, [7] = 1, [8] = 1, [9] = 2, [10] = 2, [11] = 1, [12] = 2, [13] = 1, [14] = 2}, [2] = {[0] = 1, [1] = 1, [2] = 1, [3] = 2, [4] = 1, [5] = 2, [6] = 2, [7] = 2, [8] = 1, [9] = 1, [10] = 2, [11] = 2, [12] = 2, [13] = 1, [14] = 2}, [3] = {[0] = 2, [1] = 1, [2] = 1, [3] = 2, [4] = 1, [5] = 2, [6] = 2, [7] = 1, [8] = 1, [9] = 2, [10] = 1, [11] = 1, [12] = 1, [13] = 2, [14] = 1}, [4] = {[0] = 2, [1] = 0, [2] = 2, [3] = 1, [4] = 1, [5] = 1, [6] = 2, [7] = 1, [8] = 2, [9] = 1, [10] = 1, [11] = 2, [12] = 2, [13] = 2, [14] = 1}, [5] = {[0] = 2, [1] = 1, [2] = 0, [3] = 2, [4] = 2, [5] = 1, [6] = 0, [7] = 1, [8] = 1, [9] = 2, [10] = 1, [11] = 2, [12] = 1, [13] = 2, [14] = 1}, [6] = {[0] = 2, [1] = 2, [2] = 1, [3] = 1, [4] = 1, [5] = 2, [6] = 1, [7] = 2, [8] = 1, [9] = 1, [10] = 1, [11] = 2, [12] = 1, [13] = 2, [14] = 1}, [7] = {[0] = 1, [1] = 2, [2] = 2, [3] = 1, [4] = 1, [5] = 1, [6] = 1, [7] = 2, [8] = 2, [9] = 1, [10] = 2, [11] = 1, [12] = 0, [13] = 1, [14] = 2}, [8] = {[0] = 2, [1] = 1, [2] = 2, [3] = 1, [4] = 2, [5] = 2, [6] = 2, [7] = 1, [8] = 1, [9] = 0, [10] = 1, [11] = 2, [12] = 2, [13] = 2, [14] = 2}, [9] = {[0] = 1, [1] = 1, [2] = 2, [3] = 2, [4] = 1, [5] = 1, [6] = 1, [7] = 2, [8] = 2, [9] = 2, [10] = 1, [11] = 2, [12] = 1, [13] = 2, [14] = 1}, [10] = {[0] = 1, [1] = 2, [2] = 2, [3] = 1, [4] = 1, [5] = 2, [6] = 0, [7] = 1, [8] = 1, [9] = 1, [10] = 2, [11] = 1, [12] = 2, [13] = 1, [14] = 1}, [11] = {[0] = 1, [1] = 2, [2] = 1, [3] = 1, [4] = 2, [5] = 1, [6] = 1, [7] = 1, [8] = 2, [9] = 1, [10] = 2, [11] = 1, [12] = 2, [13] = 1, [14] = 2}, [12] = {[0] = 1, [1] = 2, [2] = 2, [3] = 2, [4] = 1, [5] = 0, [6] = 2, [7] = 2, [8] = 2, [9] = 1, [10] = 1, [11] = 2, [12] = 2, [13] = 2, [14] = 1}, [13] = {[0] = 2, [1] = 2, [2] = 2, [3] = 1, [4] = 2, [5] = 2, [6] = 1, [7] = 1, [8] = 1, [9] = 2, [10] = 1, [11] = 1, [12] = 1, [13] = 1, [14] = 2}, [14] = {[0] = 2, [1] = 1, [2] = 2, [3] = 2, [4] = 1, [5] = 1, [6] = 1, [7] = 2, [8] = 2, [9] = 1, [10] = 2, [11] = 2, [12] = 2, [13] = 2, [14] = 1}, },
    //     .steps = { [0] = {.x = '\a', .y = '\a'}, [1] = {.x = '\t', .y = '\n'}, [2] = {.x = '\b', .y = '\v'}, [3] = {.x = '\x06', .y = '\n'}, [4] = {.x = '\a', .y = '\n'}, [5] = {.x = '\x06', .y = '\t'}, [6] = {.x = '\x06', .y = '\a'}, [7] = {.x = '\x06', .y = '\f'}, [8] = {.x = '\x06', .y = '\v'}, [9] = {.x = '\b', .y = '\a'}, [10] = {.x = '\a', .y = '\b'}, [11] = {.x = '\a', .y = '\v'}, [12] = {.x = '\x05', .y = '\t'}, [13] = {.x = '\b', .y = '\n'}, [14] = {.x = '\t', .y = '\t'}, [15] = {.x = '\x05', .y = '\f'}, [16] = {.x = '\x05', .y = '\r'}, [17] = {.x = '\b', .y = '\b'}, [18] = {.x = '\b', .y = '\x06'}, [19] = {.x = '\t', .y = '\x05'}, [20] = {.x = '\x04', .y = '\f'}, [21] = {.x = '\a', .y = '\r'}, [22] = {.x = '\x05', .y = '\v'}, [23] = {.x = '\x04', .y = '\t'}, [24] = {.x = '\b', .y = '\f'}, [25] = {.x = '\n', .y = '\b'}, [26] = {.x = '\t', .y = '\a'}, [27] = {.x = '\t', .y = '\f'}, [28] = {.x = '\a', .y = '\x0e'}, [29] = {.x = '\v', .y = '\x03'}, [30] = {.x = '\t', .y = '\b'}, [31] = {.x = '\x06', .y = '\x04'}, [32] = {.x = '\t', .y = '\v'}, [33] = {.x = '\f', .y = '\t'}, [34] = {.x = '\v', .y = '\n'}, [35] = {.x = '\v', .y = '\t'}, [36] = {.x = '\r', .y = '\t'}, [37] = {.x = '\f', .y = '\x04'}, [38] = {.x = '\n', .y = '\x02'}, [39] = {.x = '\x05', .y = '\x01'}, [40] = {.x = '\b', .y = '\x04'}, [41] = {.x = '\r', .y = '\n'}, [42] = {.x = '\v', .y = '\b'}, [43] = {.x = '\x03', .y = '\a'}, [44] = {.x = '\x04', .y = '\x06'}, [45] = {.x = '\n', .y = '\r'}, [46] = {.x = '\v', .y = '\f'}, [47] = {.x = '\n', .y = '\t'}, [48] = {.x = '\n', .y = '\n'}, [49] = {.x = '\n', .y = '\0'}, [50] = {.x = '\t', .y = '\r'}, [51] = {.x = '\x04', .y = '\x0e'}, [52] = {.x = '\f', .y = '\x02'}, [53] = {.x = '\t', .y = '\x01'}, [54] = {.x = '\b', .y = '\x02'}, [55] = {.x = '\x05', .y = '\a'}, [56] = {.x = '\x06', .y = '\x01'}, [57] = {.x = '\t', .y = '\0'}, [58] = {.x = '\t', .y = '\x02'}, [59] = {.x = '\v', .y = '\x02'}, [60] = {.x = '\v', .y = '\x01'}, [61] = {.x = '\a', .y = '\x05'}, [62] = {.x = '\b', .y = '\x05'}, [63] = {.x = '\b', .y = '\x03'}, [64] = {.x = '\f', .y = '\x03'}, [65] = {.x = '\v', .y = '\v'}, [66] = {.x = '\b', .y = '\0'}, [67] = {.x = '\x03', .y = '\x04'}, [68] = {.x = '\x05', .y = '\x04'}, [69] = {.x = '\n', .y = '\x04'}, [70] = {.x = '\v', .y = '\x04'}, [71] = {.x = '\x03', .y = '\x0e'}, [72] = {.x = '\x02', .y = '\x0e'}, [73] = {.x = '\x02', .y = '\x02'}, [74] = {.x = '\x03', .y = '\x05'}, [75] = {.x = '\x01', .y = '\x06'}, [76] = {.x = '\0', .y = '\a'}, [77] = {.x = '\x01', .y = '\a'}, [78] = {.x = '\x02', .y = '\a'}, [79] = {.x = '\x04', .y = '\x05'}, [80] = {.x = '\x01', .y = '\x05'}, [81] = {.x = '\x0e', .y = '\x04'}, [82] = {.x = '\x01', .y = '\x02'}, [83] = {.x = '\x0e', .y = '\x0e'}, [84] = {.x = '\x0e', .y = '\0'}, [85] = {.x = '\x05', .y = '\b'}, [86] = {.x = '\r', .y = '\x05'}, [87] = {.x = '\x03', .y = '\n'}, [88] = {.x = '\x02', .y = '\v'}, [89] = {.x = '\x05', .y = '\x05'}, [90] = {.x = '\x03', .y = '\t'}, [91] = {.x = '\a', .y = '\t'}, [92] = {.x = '\x03', .y = '\x03'}, [93] = {.x = '\x02', .y = '\t'}, [94] = {.x = '\x04', .y = '\v'}, [95] = {.x = '\x03', .y = '\v'}, [96] = {.x = '\x03', .y = '\r'}, [97] = {.x = '\0', .y = '\t'}, [98] = {.x = '\x01', .y = '\t'}, [99] = {.x = '\x04', .y = '\x03'}, [100] = {.x = '\x02', .y = '\x05'}, [101] = {.x = '\b', .y = '\x01'}, [102] = {.x = '\x05', .y = '\x03'}, [103] = {.x = '\x0e', .y = '\x01'}, [104] = {.x = '\a', .y = '\x02'}, [105] = {.x = '\x06', .y = '\x02'}, [106] = {.x = '\x04', .y = '\0'}, [107] = {.x = '\x03', .y = '\b'}, [108] = {.x = '\x01', .y = '\n'}, [109] = {.x = '\t', .y = '\x04'}, [110] = {.x = '\n', .y = '\x05'}, [111] = {.x = '\f', .y = '\0'}, [112] = {.x = '\r', .y = '\0'}, [113] = {.x = '\x02', .y = '\b'}, [114] = {.x = '\x04', .y = '\b'}, [115] = {.x = '\x06', .y = '\x03'}, [116] = {.x = '\x06', .y = '\x05'}, [117] = {.x = '\t', .y = '\x0e'}, [118] = {.x = '\x04', .y = '\x02'}, [119] = {.x = '\0', .y = '\x01'}, [120] = {.x = '\t', .y = '\x03'}, [121] = {.x = '\f', .y = '\x0e'}, [122] = {.x = '\v', .y = '\x0e'}, [123] = {.x = '\r', .y = '\r'}, [124] = {.x = '\x0e', .y = '\x02'}, [125] = {.x = '\v', .y = '\a'}, [126] = {.x = '\f', .y = '\f'}, [127] = {.x = '\x02', .y = '\x01'}, [128] = {.x = '\x0e', .y = '\f'}, [129] = {.x = '\x03', .y = '\x01'}, [130] = {.x = '\x01', .y = '\x01'}, [131] = {.x = '\x02', .y = '\0'}, [132] = {.x = '\x02', .y = '\x03'}, [133] = {.x = '\r', .y = '\a'}, [134] = {.x = '\f', .y = '\a'}, [135] = {.x = '\0', .y = '\x03'}, [136] = {.x = '\0', .y = '\x04'}, [137] = {.x = '\x0e', .y = '\x06'}, [138] = {.x = '\f', .y = '\b'}, [139] = {.x = '\x03', .y = '\x02'}, [140] = {.x = '\x01', .y = '\0'}, [141] = {.x = '\x01', .y = '\r'}, [142] = {.x = '\x0e', .y = '\x03'}, [143] = {.x = '\x0e', .y = '\t'}, [144] = {.x = '\x0e', .y = '\b'}, [145] = {.x = '\v', .y = '\r'}, [146] = {.x = '\x0e', .y = '\r'}, [147] = {.x = '\0', .y = '\x0e'}, [148] = {.x = '\x02', .y = '\f'}, [149] = {.x = '\r', .y = '\x06'}, [150] = {.x = '\f', .y = '\x06'}, [151] = {.x = '\0', .y = '\n'}, [152] = {.x = '\0', .y = '\v'}, [153] = {.x = '\x05', .y = '\n'}, [154] = {.x = '\x02', .y = '\n'}, [155] = {.x = '\x02', .y = '\r'}, [156] = {.x = '\r', .y = '\x0e'}, [157] = {.x = '\r', .y = '\x03'}, [158] = {.x = '\x03', .y = '\0'}, [159] = {.x = '\x01', .y = '\v'}, [160] = {.x = '\x01', .y = '\f'}, [161] = {.x = '\x04', .y = '\a'}, [162] = {.x = '\0', .y = '\x06'}, [163] = {.x = '\x02', .y = '\x04'}, [164] = {.x = '\0', .y = '\b'}, [165] = {.x = '\0', .y = '\x05'}, [166] = {.x = '\0', .y = '\r'}, [167] = {.x = '\a', .y = '\0'}, [168] = {.x = '\x0e', .y = '\v'}, [169] = {.x = '\x04', .y = '\n'}, [170] = {.x = '\0', .y = '\0'}, [171] = {.x = '\x0e', .y = '\x05'}, [172] = {.x = '\x04', .y = '\r'}, [173] = {.x = '\x04', .y = '\x04'}, [174] = {.x = '\n', .y = '\x01'}, [175] = {.x = '\a', .y = '\x04'}, [176] = {.x = '\n', .y = '\f'}, [177] = {.x = '\r', .y = '\f'}, [178] = {.x = '\r', .y = '\x04'}, [179] = {.x = '\n', .y = '\a'}, [180] = {.x = '\b', .y = '\x0e'}, [181] = {.x = '\x06', .y = '\x0e'}, [182] = {.x = '\x06', .y = '\r'}, [183] = {.x = '\t', .y = '\x06'}, [184] = {.x = '\f', .y = '\v'}, [185] = {.x = '\r', .y = '\b'}, [186] = {.x = '\x0e', .y = '\a'}, [187] = {.x = '\v', .y = '\x06'}, [188] = {.x = '\x01', .y = '\x0e'}, [189] = {.x = '\x03', .y = '\f'}, [190] = {.x = '\x05', .y = '\0'}, [191] = {.x = '\n', .y = '\x0e'}, [192] = {.x = '\r', .y = '\x01'}, [193] = {.x = '\x01', .y = '\b'}, [194] = {.x = '\x0e', .y = '\n'}, [195] = {.x = '\x06', .y = '\x06'}, [196] = {.x = '\0', .y = '\f'}, [197] = {.x = '\x06', .y = '\b'}, [198] = {.x = '\x01', .y = '\x03'}, [199] = {.x = '\f', .y = '\n'}, [200] = {.x = '\b', .y = '\r'}, [201] = {.x = '\r', .y = '\v'}, [202] = {.x = '\x06', .y = '\0'}, [203] = {.x = '\a', .y = '\x03'}, [204] = {.x = '\a', .y = '\x01'}, [205] = {.x = '\x05', .y = '\x0e'}, [206] = {.x = '\f', .y = '\x01'}, [207] = {.x = '\v', .y = '\0'}, [208] = {.x = '\f', .y = '\r'}, [209] = {.x = '\v', .y = '\x05'}, [210] = {.x = '\r', .y = '\x02'}, [211] = {.x = '\a', .y = '\x06'}, [212] = {.x = '\0', .y = '\x02'}, [213] = {.x = '\n', .y = '\v'}, [214] = {.x = '\x02', .y = '\x06'}, [215] = {.x = '\n', .y = '\x03'}, [216] = {.x = '\x03', .y = '\x06'}, [217] = {.x = '\0', .y = '\0'}, [218] = {.x = '\0', .y = '\0'}, [219] = {.x = '\0', .y = '\0'}, [220] = {.x = '\0', .y = '\0'}, [221] = {.x = '\0', .y = '\0'}, [222] = {.x = '\0', .y = '\0'}, [223] = {.x = '\0', .y = '\0'}, [224] = {.x = '\0', .y = '\0'}, },
    //     .time_limit = 300,
    //     .count = 217,
    //     .cur_id = 1,
    //     .first_id = 2,
    // };

    // game_t game3 = game_import(3000,2,83,(point_t[]){{7,7},{8,7},{7,8},{7,6},{9,8},{8,8},{8,9},{7,10},{9,10},{6,7},{10,11},{11,12},{8,5},{9,7},{6,10},{10,6},{11,5},{12,6},{9,6},{7,4},{11,7},{6,5},{5,4},{8,3},{5,6},{6,6},{6,4},{10,12},{6,9},{9,12},{12,12},{7,2},{7,3},{10,5},{9,4},{10,4},{10,7},{5,5},{10,13},{4,5},{3,5},{4,6},{4,4},{2,6},{3,7},{7,5},{4,8},{8,4},{9,3},{6,11},{10,2},{5,11},{7,11},{5,9},{5,10},{2,5},{2,7},{3,4},{1,6},{13,9},{2,3},{12,10},{11,11},{0,7},{6,1},{12,4},{12,7},{6,12},{4,10},{7,12},{8,12},{5,1},{5,12},{9,11},{9,14},{8,10},{11,13},{13,13},{13,11},{11,0},{8,6},{10,1},{9,2}});
    // // mcts vs minimax

    // game_t game4 = game_import(5000,2,58,(point_t[]){{7,7},{8,8},{8,6},{6,8},{9,7},{7,8},{9,8},{9,6},{8,7},{10,7},{10,9},{11,10},{11,9},{12,10},{10,10},{12,9},{6,7},{5,7},{7,6},{6,5},{8,5},{5,8},{4,8},{10,11},{9,12},{12,8},{12,7},{4,6},{3,5},{5,9},{5,10},{13,6},{3,6},{3,4},{4,5},{2,7},{1,5},{5,6},{5,5},{2,5},{4,10},{7,4},{8,3},{8,4},{4,11},{4,7},{3,8},{10,4},{9,4},{10,3},{3,10},{6,10},{2,9},{1,8},{7,2},{6,1},{3,12},{10,6}});
    // check dangerous position

    // game_t game2 = game_import(2000,1,7,(point_t[]){{7,7},{6,7},{6,8},{8,6},{8,8},{6,9},{5,5},{6,6},{7,8},{5,8},{7,6},{7,9},{5,4}});

    // game_t game2 = game_import(3000,1,7,(point_t[]){{7,7},{8,7},{8,6},{7,8},{7,5},{6,8},{6,4}});

    // game_print(game2);

    // prompt_pause();

    // while (1) {
    //     mcts(game2, &mcts_params_default);
    // }


    #include "boards.txt"
    
    board_t board;
    point_t pos;
    point_t parse_board(board_t dest, const char* str); // in tests/forbid.c
    param.check_depth = 2;
    first_id = 1;
    for (int i = 0; i < TESTS; i++) {
        log("i = %d", i);
        pos = parse_board(board, tests[i].str);
        emphasis_print(board, pos);
        comp_board_t bd;
        encode(board, bd);
        const pattern4_t forbid = is_forbidden_comp(bd, pos, 1, 4);
        log("got %s, expected %s", pattern4_typename[forbid], pattern4_typename[tests[i].id]);
        if (forbid != tests[i].id) {
            log_e("failed.");
            exit(1);
        }
    }
    game_t test_game = game_import(3000,2,22,(point_t[]){{7,7},{7,8},{8,8},{9,9},{8,6},{9,5},{8,7},{8,9},{6,7},{5,7},{9,7},{10,7},{8,5},{8,4},{7,6},{5,8},{6,6},{9,6},{5,5},{4,4},{4,6},{5,6}});

    first_id = 2;
    game_t test_game2 = game_import(1000,2,42,(point_t[]){{7,7},{8,9},{6,7},{8,7},{7,6},{8,8},{8,6},{7,5},{6,8},{9,5},{5,8},{8,5},{6,5},{6,6},{4,8},{3,8},{5,9},{4,10},{5,10},{5,11},{6,10},{7,11},{2,10},{3,9},{2,8},{4,11},{6,11},{6,9},{2,9},{2,7},{7,12},{9,14},{9,10},{6,13},{3,7},{2,6},{4,6},{5,5},{4,7},{5,7},{4,5},{4,4}});
    extern mcts_param_t mcts_params_default;
    point_t p = mcts(test_game, &mcts_params_default);
    // point_t p = (point_t){6, 5};
    comp_board_t cpb;
    encode(test_game.board, cpb);
    board_t raw_board;
    decode(cpb, raw_board);
    emphasis_print(raw_board, p);
    log("virtual_pat4 get %s", pattern4_typename[virtual_pat4type_comp(cpb, p, test_game.cur_id, 4)]);
    log("first id: %d", first_id);
    if (is_forbidden_comp(cpb, p, test_game.cur_id, 1)) log("compressed check return forbidden");
    else log("compressed check return accepted");
    assert(!is_forbidden(test_game.board, p, test_game.cur_id, true));
}
